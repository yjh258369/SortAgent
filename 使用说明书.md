# SortAgent 使用说明书

> 智能文档整理助手 | 版本 1.0 | 更新日期：2026-02-28

---

## 简介

**SortAgent** 是一款专为 Claude Code 设计的智能文档整理工具。它提供了可视化的仪表盘界面，帮助你高效地管理、分析和整理文档集合。

### 主要功能

- **可视化仪表盘** - 交互式 Web 界面，操作简单直观
- **智能文件分析** - 自动生成摘要和标签
- **多种任务模式** - 完整整理、快速整理、仅分析、自定义
- **一键启动** - 与 Claude Code 无缝集成
- **协议处理器** - 系统级集成，工作流更顺畅

---

## 一、环境配置

### 1.1 系统要求

| 项目 | 要求 |
|------|------|
| 操作系统 | Windows 10/11（推荐）/ Mac / Linux |
| 浏览器 | Chrome / Edge / Firefox（现代浏览器） |
| AI 工具 | Claude Code（必须安装） |

### 1.2 安装 Claude Code

Claude Code 是 Anthropic 官方的命令行工具，是运行 SortAgent 的必要条件。

```bash
# 使用 npm 安装
npm install -g @anthropic-ai/claude-code

# 验证安装
claude --version
```

### 1.3 获取 SortAgent

将 SortAgent 项目下载到本地任意目录即可使用。

### 1.4 安装协议处理器（可选）

协议处理器可以实现一键启动 Claude Code，仅 Windows 系统支持。

**安装步骤：**

1. 双击运行 `setup_protocol.reg`
2. 确认注册表添加
3. 创建 `C:\claude-launcher\` 目录
4. 将 `launcher.vbs` 和 `launcher.bat` 复制到该目录

---

## 二、首次使用

### 2.1 启动仪表盘

1. 打开项目目录
2. 双击 `dashboard.html` 文件
3. 浏览器将自动打开 SortAgent 仪表盘

### 2.2 界面概览

```
┌─────────────────────────────────────────────────────┐
│  🚀 Sort Agent - 智能文档整理                        │
├─────────────────────────────────────────────────────┤
│  任务模式选择                                        │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌────────┐ │
│  │ 完整整理 │ │ 快速整理 │ │ 仅分析   │ │ 自定义 │ │
│  └──────────┘ └──────────┘ └──────────┘ └────────┘ │
├─────────────────────────────────────────────────────┤
│  任务步骤                                            │
│  ☑ 扫描文件    ☑ 读取内容    ☑ 生成摘要    ☑ 添加标签 │
│  ☐ 相似度分析  ☐ 生成README  ☐ 优化结构              │
├─────────────────────────────────────────────────────┤
│  📁 目标目录: [选择你的文档目录]                      │
│  [选择目录]  [开始执行]                              │
└─────────────────────────────────────────────────────┘
```

### 2.3 选择目标目录

1. 点击 **"选择目录"** 按钮
2. 在弹出的对话框中选择你要整理的文档文件夹
3. 确认选择后，路径会显示在界面上

---

## 三、任务模式说明

SortAgent 提供四种任务模式：

| 模式 | 步骤数 | 说明 | 适用场景 |
|------|--------|------|----------|
| 完整整理 | 7 步 | 完整的文档整理流程 | 全面整理文档库 |
| 快速整理 | 4 步 | 跳过深度分析和优化 | 快速更新文档 |
| 仅分析 | 4 步 | 只读分析，不修改文件 | 了解现有文档 |
| 自定义 | 可变 | 手动选择执行步骤 | 特定需求 |

### 3.1 完整整理（7 步）

完整执行以下所有步骤：

1. **扫描文件** - 查找目录下所有 .md 文件
2. **读取内容** - 提取每个文件的文本内容
3. **生成摘要** - 为每个文件创建 200 字摘要
4. **添加标签** - 添加时间、类型、重要性、主题标签
5. **相似度分析** - 查找重复和相似内容
6. **生成 README** - 创建结构化索引文件
7. **优化结构** - 重命名、合并、归档文件

### 3.2 快速整理（4 步）

执行步骤：1 → 2 → 3 → 6（跳过分析和优化）

### 3.3 仅分析（4 步）

执行步骤：1 → 2 → 3 → 4（只读模式，不修改任何文件）

### 3.4 自定义

手动勾选需要执行的步骤。

---

## 四、执行任务

### 4.1 选择任务模式

在仪表盘中点击对应的模式按钮：
- 点击 **"完整整理"** 执行全部 7 步
- 点击 **"快速整理"** 执行 4 步快速流程
- 点击 **"仅分析"** 只进行分析
- 点击 **"自定义"** 手动选择步骤

### 4.2 开始执行

1. 确认目标目录正确
2. 确认任务步骤符合需求
3. 点击 **"开始执行"** 按钮

### 4.3 启动 Claude Code

执行对话框出现后：

1. 点击 **"启动 Claude Code"** 按钮
2. 点击 **"复制提示词"** 按钮（绿色按钮）
3. 切换到 Claude Code 窗口
4. 按 **Ctrl + V** 粘贴提示词
5. 按 **Enter** 执行

### 4.4 等待完成

Claude Code 会自动执行所有步骤，完成后会生成：
- `README.md` - 文档索引
- `FILE_ANALYSIS.md` - 详细分析报告
- `EXECUTION_LOG.md` - 执行日志

---

## 五、输出文件说明

### 5.1 README.md

结构化的文档索引，包含：
- 📂 按类型分组的文档列表
- ⭐ 按重要性分级（5星到1星）
- 🏷️ 标签索引
- 🔍 快速查找指南
- ⚠️ 待办事项

### 5.2 FILE_ANALYSIS.md

详细的文件分析报告，包含：
- 每个文件的摘要
- 完整的标签数据
- 重复内容分析
- 处理建议

### 5.3 EXECUTION_LOG.md

操作执行记录，包含：
- 执行时间
- 处理文件数量
- 操作统计
- 问题记录

### 5.4 archive/ 目录

原始文件的备份目录，防止误操作丢失数据。

---

## 六、快捷键

| 快捷键 | 功能 |
|--------|------|
| Ctrl + V | 在 Claude Code 中粘贴提示词 |
| Enter | 发送提示词 |
| Esc | 取消对话框 |

---

## 七、常见问题

### Q1: 提示"目录未找到"

**解决方案：** 检查路径格式，确保路径存在。

### Q2: Claude Code 无法启动

**解决方案：**
1. 确认 Claude Code 已正确安装
2. 检查 PATH 环境变量
3. 尝试手动启动 Claude Code

### Q3: 复制的提示词是乱码

**解决方案：** 点击绿色的"复制提示词"按钮，而不是"启动"按钮。

### Q4: 工作目录错误

**解决方案：** 提示词中包含 `cd` 命令，等待 Claude Code 先执行切换目录。

### Q5: 可以用于其他 AI 工具吗？

**答案：** 可以！生成的提示词适用于任何能执行 shell 命令的 AI 助手。

### Q6: SortAgent 会修改我的文件吗？

**答案：** 只有"完整整理"模式且启用了步骤 7 才会修改文件。"仅分析"模式是只读的。

### Q7: Mac/Linux 可以使用吗？

**答案：** 仪表盘可以在任何浏览器中使用。协议处理器仅支持 Windows。

---

## 八、技术支持

- **完整文档**：参见 [USER_MANUAL.md](./USER_MANUAL.md)
- **开发框架**：参见 [FRAMEWORK.md](./FRAMEWORK.md)
- **快速指南**：参见 [QUICK_USE.md](./QUICK_USE.md)

---

*SortAgent v1.0 - 智能文档整理助手*
