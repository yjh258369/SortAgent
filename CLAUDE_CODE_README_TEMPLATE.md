# Claude Code 任务编排模板

> 通用的文档整理与分析任务框架
> 版本：1.0
> 适用于：Claude Code / Cursor / 任何 AI 编程助手

---

## 📋 任务模板

### 完整任务提示词（复制即可使用）

```
请帮我整理 [目标目录] 目录下的所有 [文件类型] 文件：

【第一阶段：扫描与读取】
1. 扫描目录，列出所有符合条件的文件
2. 读取每个文件的完整内容
3. 统计文件数量、总行数、总字符数

【第二阶段：分析与摘要】
4. 为每个文件生成 200 字以内的摘要
   - 提取核心信息和关键事件
   - 突出技术细节和配置参数
   - 使用简洁的专业语言

5. 为每个文件打标签：
   - 时间标签：创建日期、更新日期、时间跨度
   - 类型标签：配置文档/技术日志/会话记录/API文档/其他
   - 重要性标签：⭐(1-5星)
     * ⭐ - 低价值，可删除
     * ⭐⭐ - 参考价值低
     * ⭐⭐⭐ - 一般参考
     * ⭐⭐⭐⭐ - 重要文档
     * ⭐⭐⭐⭐⭐ - 关键文档，必须保留
   - 主题标签：根据内容提取（如 OpenClaw/MySQL/Docker 等）

【第三阶段：智能分析】
6. 重复内容识别：
   - 对比所有文件的摘要
   - 找出相似度 >50% 的内容
   - 标注重复类型：完全重复/部分重复/状态更新/无重复
   - 提供处理建议（保留/合并/删除）

【第四阶段：生成文档】
7. 创建 README.md 索引文档，包含：
   - 📂 文档列表（按类型分组）
   - 📊 重要性分组（5星到1星）
   - 🏷️ 标签索引（按时间/类型/主题）
   - 🔍 快速查找指南
   - ⚠️ 待办事项清单（从文档中提取）
   - 📈 统计数据

8. 创建 FILE_ANALYSIS.md 分析报告，包含：
   - 每个文件的详细摘要
   - 完整的标签数据
   - 重复内容分析
   - 文件优化建议

【第五阶段：优化结构】
9. 文件优化（可选，需确认）：
   - 重命名文件：YYYY-MM-DD_description.md 格式
   - 删除重复冗余文件
   - 合并高度重复的文件
   - 创建备份到 archive/ 目录

【输出要求】
- 所有文档使用 Markdown 格式
- 添加适当的 emoji 增强可读性
- 链接使用相对路径
- 生成执行日志记录所有操作
```

---

## ⚙️ 参数配置

```json
{
  "target_directory": "./docs/",
  "file_types": [".md", ".txt", ".json"],
  "summary_length": 200,
  "importance_threshold": 2,
  "duplicate_threshold": 0.5,
  "backup_enabled": true,
  "require_confirmation": true,
  "output_files": {
    "readme": "README.md",
    "analysis": "FILE_ANALYSIS.md",
    "log": "EXECUTION_LOG.md"
  }
}
```

### 参数说明

| 参数 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| `target_directory` | string | `./docs/` | 目标目录路径 |
| `file_types` | array | `[".md"]` | 要处理的文件类型 |
| `summary_length` | number | 200 | 摘要字数上限 |
| `importance_threshold` | number | 2 | 低于此星级的文件将被标记删除 |
| `duplicate_threshold` | float | 0.5 | 相似度阈值（0-1） |
| `backup_enabled` | boolean | true | 是否创建备份 |
| `require_confirmation` | boolean | true | 删除操作是否需要确认 |

---

## 🎯 使用场景

### 场景 1：技术文档整理
```bash
# 整理项目文档目录
目标目录：./docs/
文件类型：.md
重点：API 文档、配置说明、变更日志
```

### 场景 2：会议记录归档
```bash
# 整理会议记录
目标目录：./meetings/
文件类型：.md
重点：会议时间、参会人员、决议事项
```

### 场景 3：日志文件分析
```bash
# 分析系统日志
目标目录：./logs/
文件类型：.log, .txt
重点：错误信息、异常时间、关键事件
```

### 场景 4：知识库构建
```bash
# 构建个人知识库
目标目录：./knowledge/
文件类型：.md, .txt
重点：知识点分类、标签系统、快速检索
```

---

## 📝 自定义提示词模板

### 模板 1：最小化版本（快速整理）

```
整理 [目录] 的 .md 文件：
1. 生成 200 字摘要
2. 打标签（时间/类型/重要性 1-5星）
3. 创建 README 索引
4. 删除 <2 星的文件
```

### 模板 2：深度分析版本

```
深度分析 [目录] 的文档：

【内容分析】
- 提取关键技术点
- 识别配置参数
- 标记待办事项
- 发现潜在问题

【关系分析】
- 文件间依赖关系
- 内容演进时间线
- 重复内容识别

【结构优化】
- 建议的目录结构
- 文件命名规范
- 归档策略

输出：
1. 分析报告（ANALYSIS.md）
2. 优化建议（RECOMMENDATIONS.md）
3. 执行计划（ACTION_PLAN.md）
```

### 模板 3：持续集成版本

```
检查 [目录] 并更新索引：

【增量更新】
1. 识别新增/修改的文件
2. 只处理变更的文件
3. 更新 README 索引

【质量检查】
1. 检查文件命名规范
2. 验证标签完整性
3. 标记低质量内容

【自动修复】
1. 修复格式问题
2. 补充缺失标签
3. 更新过期内容

输出执行报告。
```

---

## 🔄 执行策略

### 策略 1：一次性完整执行
```
适用场景：首次整理、大规模重构
执行方式：完整运行所有 5 个阶段
预计耗时：10-30 分钟（取决于文件数量）
```

### 策略 2：分步执行
```
适用场景：需要人工审核、分阶段确认
执行方式：
  第一步：扫描 + 分析（阶段 1-3）
  第二步：生成文档（阶段 4）
  第三步：优化结构（阶段 5，需确认）
预计耗时：每步 5-10 分钟
```

### 策略 3：增量执行
```
适用场景：日常维护、定期更新
执行方式：只处理新增/修改的文件
预计耗时：2-5 分钟
执行频率：每天/每周
```

---

## ✅ 验证清单

执行完成后检查：

### 文件完整性
- [ ] 所有文件都已生成摘要
- [ ] 每个文件都有完整的标签
- [ ] 没有遗漏重要文件

### 文档质量
- [ ] README.md 链接全部有效
- [ ] 摘要准确概括内容
- [ ] 标签分类合理

### 结构优化
- [ ] 文件命名规范统一
- [ ] 低价值文件已处理
- [ ] 重复内容已识别

### 安全性
- [ ] 已创建备份
- [ ] 操作日志完整
- [ ] 可回滚操作

---

## 🚨 常见问题

### Q1: 文件太多（>100个）怎么办？
```bash
# 分批处理
1. 先按类型分组
2. 每次处理 20-30 个文件
3. 最后合并索引
```

### Q2: 如何处理二进制文件？
```bash
# 跳过二进制文件，或使用专门工具
file_types: [".md", ".txt", ".json"]
# 不包含 .pdf, .docx 等
```

### Q3: 如何保留原始文件？
```bash
# 启用备份
backup_enabled: true
backup_directory: "./archive/"
```

### Q4: 误删重要文件怎么办？
```bash
# 从备份恢复
cp archive/filename.md ./

# 或使用 git 恢复
git checkout -- filename.md
```

### Q5: 如何自定义标签系统？
```bash
# 在提示词中添加自定义标签
自定义标签：
- 项目阶段：规划/开发/测试/上线
- 受众：开发/运维/产品/全部
- 状态：草稿/审核/已发布/已过期
```

---

## 📊 输出示例

### README.md 结构示例

````markdown
# 文档索引

> 最后更新：2026-02-27

## 📂 文档列表

### 配置文档 (3)
- [系统配置](./config.md) ⭐⭐⭐⭐⭐ - 核心系统配置
- [网络设置](./network.md) ⭐⭐⭐⭐ - 网络参数配置
- [环境变量](./env.md) ⭐⭐⭐ - 环境变量说明

### 技术日志 (2)
- [部署记录](./deploy-2026-02-27.md) ⭐⭐⭐⭐ - 生产环境部署
- [问题排查](./debug.md) ⭐⭐⭐ - 常见问题解决方案

## 🏷️ 标签索引

### 按重要性
- ⭐⭐⭐⭐⭐: config.md
- ⭐⭐⭐⭐: network.md, deploy-2026-02-27.md
- ⭐⭐⭐: env.md, debug.md

### 按主题
- **系统**: config.md, env.md
- **网络**: network.md
- **部署**: deploy-2026-02-27.md

## 🔍 快速查找

**配置系统参数？** → [config.md](./config.md)
**网络连接问题？** → [network.md](./network.md)
**部署遇到错误？** → [debug.md](./debug.md)

## 📈 统计数据
- 总文件数：5
- 配置文档：3
- 技术日志：2
- 平均重要性：⭐⭐⭐⭐
````

---

## 🛠️ 高级用法

### 1. 与 Git 集成

```bash
# 在 git hooks 中自动执行
# .git/hooks/pre-commit

#!/bin/bash
# 提交前自动更新文档索引
claude-code "更新 docs/ 目录的 README 索引"
git add docs/README.md
```

### 2. 与 CI/CD 集成

```yaml
# .github/workflows/docs.yml
name: Update Docs Index
on:
  push:
    paths: ['docs/**']

jobs:
  update-index:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Update README
        run: |
          claude-code "更新 docs/ 目录索引"
      - name: Commit changes
        run: |
          git config user.name "CI Bot"
          git commit -am "docs: auto-update index"
          git push
```

### 3. 定时任务

```bash
# crontab -e
# 每周一凌晨 2 点自动整理文档
0 2 * * 1 cd /path/to/project && claude-code "整理 docs/ 目录"
```

---

## 📚 扩展阅读

### 相关工具
- **Logseq**: 双向链接笔记系统
- **Obsidian**: 知识库管理工具
- **Foam**: VSCode 知识库插件
- **Dendron**: 层级化笔记系统

### 最佳实践
1. **命名规范**：使用统一的文件命名格式
2. **定期维护**：每周/每月定期整理
3. **标签体系**：建立标准化的标签系统
4. **版本控制**：使用 Git 管理文档变更
5. **模板复用**：创建可复用的文档模板

---

## 📄 许可证

本模板采用 MIT 许可证，可自由使用、修改和分发。

---

## 🤝 贡献

欢迎提交改进建议：
- 新的使用场景
- 优化的提示词
- 更好的标签系统
- 自动化脚本

---

**版本历史**
- v1.0 (2026-02-27): 初始版本
